{% extends "base.html" %} {% load static %} {% block content_head %}
<link rel="stylesheet" type="text/css" href="{% static 'blogs/css/blog_content.css' %}">
<script src="{% static 'js/blogs/subtopic.js' %}"></script> {% endblock %} {% block content %}
{% block title %}
<title>{{ project.title |title}}</title>
{% endblock %}
{%csrf_token%}
<style>
	input{
                position: relative !important;
                display: inline !important;
                border: 3px solid orange;
            }
    p:hover, .field:hover, h1:hover{
        color: orange;
    }
    .sugg_btn{
        display: inline !important;
    }
</style>
<script>
    var suggestions
    function getSuggestion(){
		$.ajax({
			method:'GET',
			url:  "{% url 'api:get_suggestion'%}",
			data:{
				'project':'{{project.pk}}',
				// 'content':document.getElementById('sugg_inp').value,
				// 'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val(),
			},
			success:function(data){
                sug = document.getElementById('suggestions-list')
                sug.innerHTML = ""
                if( '{{request.user.is_superuser}}' == 'True' || '{{request.user}}' == '{{project.author.user}}'){
                for (var i = 0; i < data.suggestions.length; i++) {
                    sug.innerHTML += '<div class="row"><div class="col-1"><span class="glyphicon glyphicon-user"></span></div><div class="col-11"><h5>' + data.suggestions[i].content  +'-'+data.suggestions[i].created_on +'</h5></div></div>'
                    sug.innerHTML +='<button type="button" onclick="resolveSuggestion(this)" data-pk = "' + data.suggestions[i].id +'">Resolve</button>'
                }
            }
			},error:function(error){
				alert('error')
			},
        })
    }
        getSuggestion()
	function addSuggestion(){
		$.ajax({
			method:'POST',
			url:  "{% url 'api:create_suggestion'%}",
			data:{
				'project':'{{project.pk}}',
				'content':document.getElementById('sugg_inp').value,
				'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val(),
			},
			success:function(data){
				getSuggestion()
			},error:function(error){
				alert('error')
			},
		})
        // location.reload()
	}
	function resolveSuggestion(e){
        // alert(e.getAttribute('data-pk'))
        var pk = e.getAttribute('data-pk')
		$.ajax({
			method:'POST',
			url:  "{% url 'api:resolve_suggestion'%}",
			data:{
				'pk': pk,
				'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val(),
			},
			success:function(data){
                getSuggestion()
			},error:function(error){
				alert('error')
			},
        })
	}
</script>
<div class="center">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'blogs:index' %}">Home</a></li>
        <li class="breadcrumb-item"><a href="{% url 'blogs:sub_topic' slug=chapter_heading  %}">{{ project.topic | title }}</a></li>
    </ol>
</div>
<div class="img2 row img3">
    <img src="/media/images/layer.png" class="col-md-12 layer1">
    </div> 
<div class="team-section">
	<div class="container">
	  <div class="row row1">
		<div class="col-md-2"></div>
		<div class="col-md-8 white">
			<br>
			<br>
		  <div class="section-heading">
			<h1>{{ project.title }}</h1>
			<p>BY {{project.author}} &emsp;<span class="vertical">|</span>&emsp; {{project.date_approved}}</p>
			<br>
			<div class="dow">Share on	</div>
			<div class="sh">
			<span class="shares"><div class="number">1</div><br><div class="number2">shares</div></span>
			<img src="/media/images/google+share.png" class="shareon">
			<img src="/media/images/mail-share.png" class="shareon">
			<img src="/media/images/linkdin-share.png" class="shareon">
			<img src="/media/images/whatsapp-share.png" class="shareon">
			<img src="/media/images/twitter-share.png" class="shareon">
			<img src="/media/images/facebook-share.png" class="shareon">
			
			</div>
		  </div>
		  <br>
		  <br>

		  <div class="top-1">
			<p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Sint repellendus itaque hic eum cupiditate, rem eaque incidunt molestiae quaerat veniam tempore quasi consequatur ipsa eveniet modi debitis rerum illum maxime.</p>
			<br><h5>What will you do in this course:</h5>
			<p>{{ project.description }}</p>
            <br><h5>Pre-Requisities for this course?</h5>
            {% for pre_req in project.pre_req.all %}
            <p>{{pre_req}}</p>
            {% endfor %}
			<br><div class="spans">
			<span><h5>Hours To Complete:</h5></span><div  class="field">{{ project.no_of_hours }}</div><br>
			<span><h5>Level:</h5></span><div  class="field">{{ project.difficulty_level}}</div><br>
			<span><h5>Languages Used:</h5></span>
			<div  class="field">
				{% if language.image.url %}   {% for language in project.languages.all %} 
                    <img src="{{language.image.url}}" class="la"> {% endfor %} {% endif %} 
			   <!-- <img src="/media/images/java.png" class="la">
			   <img src="/media/images/kotlin.png" class="la">
			   <img src="/media/images/c.png" class="la">
			   <img src="/media/images/php.png" class="la">
			   <img src="/media/images/python.png" class="la"> -->
			</div>
			<br>
			<span><h5>Author Name:</h5></span><div  class="field">{{project.author}}</span><br>
		  </div>
          </div>
          {% if chapters %} {% for chapter in chapters %}
<div class="boxes">
<div class="box">
	<div class="right-num">{{ forloop.counter }}</div>	<div class="mid">
		<a href="{% url 'blogs:chapter_post' slug=chapter_heading chapter=chapter.slug %}" id="blogLink" class="add">
            {{ chapter.heading }} 
        </a><br>
        <span class="clk">{{ chapter.description }}</span>
        </div>
        {% include 'dropdown/dropdown.html' with url=project.getCompleteUrl function="copyCurrentPageURLToClipBoard()" %}
    </div>
        {% endfor %}
   
         {% else %}
    <h1>No blogs for the particular url</h1>
    {% endif %}
	<!-- <img src="/media/images/share1.png" class="left-share"> -->

<!-- <div class="box">
	<div class="right-num">02</div>	<div class="mid">
		<span class="add">Adding images to your site</span><br>
		 <span class="clk">There are ways by which your image can be made clickable...</span>
		</div>
	<img src="share1.png" class="left-share">
</div>
<div class="box">
	<div class="right-num">03</div>	<div class="mid">
		<span class="add">Adding images to your site</span><br>
		 <span class="clk">There are ways by which your image can be made clickable...</span>
		</div>
	<img src="share1.png" class="left-share">
</div>
<div class="box">
	<div class="right-num">04</div>	
	<div class="mid">
		<span class="add">Adding images to your site</span><br>
		 <span class="clk">There are ways by which your image can be made clickable...</span>
	</div>
	<img src="share1.png" class="left-share">
</div>
<div class="box">
	<div class="right-num">05</div>
	<div class="mid">
		<span class="add">Adding images to your site</span><br>
		 <span class="clk">There are ways by which your image can be made clickable...</span>
	</div>
	<img src="share1.png" class="left-share">
</div>
<div class="box">
	<div class="right-num">06</div>
	<div class="mid">
	<span class="add">Adding images to your site</span><br>
	 <span class="clk">There are ways by which your image can be made clickable...</span>
	</div>
	<img src="share1.png" class="left-share">
</div>
</div> -->
</div> 
<div class="section-heading">
<h4>About the Author</h4>
<br>
<img src="{{project.author.dp.url}}" class="author">
<div class="box box55">
	<br>
	<br>
	<h3>{{project.author}}</h3>
	<div>{{project.author.description}}</div>
</div> 

</div>

</div>
<div class="col-md-2"></div>
{% if request.user.is_superuser and  not project.isApproved%}
<!-- <span><button type="button" onclick="addSuggestion()">Add suggestion</button>
	<label for="title_input">title</label>
<input type="text" id="title_input" style="color: aqua;">
<input type="text" id="content_input">
<br> -->
<!-- <button type="button" onclick="resolveSuggestion()">Resolve</button> -->
{%endif%}
</div>
</div>
</div>
</div>
</div>
<div id="suggestions-list"></div>
<script>
    var fields = document.getElementsByClassName('field')
    if( '{{request.user.is_superuser}}' == 'True'){
    for(var i = 0; i< fields.length; i++ ){
        fields[i].addEventListener('mouseover', function(e){
            
            // alert(e.target.getAttribute('class'))
            if(document.getElementById('sugg_btn') != null &&  e.target.getAttribute('class') != 'sugg_btn'){
                document.getElementById('sugg_btn').remove()
            }

            if(e.target.getAttribute('class') != 'sugg_btn' ){
                var btn = document.createElement('button')
                btn.setAttribute('class', 'sugg_btn')
                btn.innerHTML = 'ADD SUGGESTION'
                btn.setAttribute('id', 'sugg_btn')
                btn.setAttribute('onclick', 'createInputBox(this);')
                // e.target.appendChild(btn)
                e.target.insertBefore(btn, e.target.firstChild.nextSibling);
            }
        })
    }
}

    p_tags = document.getElementsByTagName('p')
    if( '{{request.user.is_superuser}}' == 'True'){
    for(var i = 0; i< p_tags.length; i++ ){
        p_tags[i].addEventListener('mouseover', function(e){
            
            // alert(e.target.getAttribute('class'))
            if(document.getElementById('sugg_btn') != null &&  e.target.getAttribute('class') != 'sugg_btn'){
                document.getElementById('sugg_btn').remove()
            }

            if(e.target.getAttribute('class') != 'sugg_btn' ){
                var btn = document.createElement('button')
                btn.setAttribute('class', 'sugg_btn')
                btn.innerHTML = 'ADD SUGGESTION'
                btn.setAttribute('id', 'sugg_btn')
                btn.setAttribute('onclick', 'createInputBox(this);')
                // e.target.appendChild(btn)
                e.target.insertBefore(btn, e.target.firstChild.nextSibling);
            }
        })
    }
}
    var title = document.getElementsByTagName('h1')
    if( '{{request.user.is_superuser}}' == 'True'){
    for(var i = 0; i< title.length; i++ ){
        title[i].addEventListener('mouseover', function(e){
            
            // alert(e.target.getAttribute('class'))
            if(document.getElementById('sugg_btn') != null &&  e.target.getAttribute('class') != 'sugg_btn'){
                document.getElementById('sugg_btn').remove()
            }

            if(e.target.getAttribute('class') != 'sugg_btn' ){
                var btn = document.createElement('button')
                btn.setAttribute('class', 'sugg_btn')
                btn.innerHTML = 'ADD SUGGESTION'
                btn.setAttribute('id', 'sugg_btn')
                btn.setAttribute('onclick', 'createInputBox(this);')
                // e.target.appendChild(btn)
                e.target.insertBefore(btn, e.target.firstChild.nextSibling);
            }
        })
    }
}


    
    // for(var i = 0; i< fields.length; i++ ){
    //     fields[i].addEventListener('mouseout', function(e){
    //         // alert(e.target.getAttribute('class'))
    //         if(document.getElementById('sugg_btn') != null &&  e.target.getAttribute('class') != 'field' && e.target.getAttribute('class') != 'sugg_btn'){
    //             document.getElementById('sugg_btn').remove()
    //         }
    //     })
    // }

    function createInputBox(e){
        if(document.getElementById('sugg_inp') == null){
        var inp = document.createElement('input')
        inp.id = "sugg_inp"
        // alert(e.parentNode)
        // document.getElementById('sugg_btn').remove()
        e.parentNode.appendChild(inp)
        
        }

        // alert('y')
        
    }
    document.addEventListener('keyup', function(e){
        // alert(e.keyCode)
        if (e.keyCode == "13"){
            // alert("6")
            if(document.getElementById('sugg_inp') != null){
                var value = document.getElementById('sugg_inp').value
                addSuggestion();
                // alert(value)   
            }
            document.getElementById('sugg_inp').remove()
        }
    })
</script>

{% endblock %}

